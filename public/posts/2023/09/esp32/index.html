<!doctype html><html lang=fr><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Blog qui parle de lecture et de web"><meta name=keywords content="hugo,html,lecture,web,shortcode"><title>Schrek.fr</title>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><meta name=mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-title content="My PWA"><meta name=apple-mobile-web-app-status-bar-style content="black-translucent"><script>"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js")</script><meta property="og:url" content="https://schrek.fr/posts/2023/09/esp32/"><meta property="og:site_name" content="Schrek.fr"><meta property="og:title" content="Decouverte de l'Esp32"><meta property="og:description" content="Esp32 est un microcontrôleur qui va nous permettre de faire des objets connectés grâce a son module Wifi et Bluetooth intégré. Il dispose de plusieurs sorties et entrées pour connecter par exemple des capteurs ou des LED.
On va utiliser Micropython pour assurer la programmation."><meta property="og:locale" content="fr_fr"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-09-05T00:00:00+00:00"><meta property="article:modified_time" content="2023-09-05T00:00:00+00:00"><meta property="article:tag" content="Esp32"><meta property="article:tag" content="MicroPython"><meta property="article:tag" content="Linux"><meta property="og:see_also" content="https://schrek.fr/posts/2023/10/esp32-et-un-ecran-oled/"><meta property="og:see_also" content="https://schrek.fr/posts/2023/10/communiquer-avec-esp32/"><link href=/css/uikit.min.min.74065b0cc0cc771b6d0c8cdd1571f95022330dbe057cfe7f5c22ddf003313c6715e6047ab88bb5766ca27342b6d7b572f78f0fa2110438c5a0edeb269788d553.css rel=stylesheet integrity="sha512-dAZbDMDMdxttDIzdFXH5UCIzDb4FfP5/XCLd8AMxPGcV5gR6uIu1dmyic0K217Vy948PohEEOMWg7esml4jVUw==" crossorigin=anonymous><link href=/css/styles.min.c8d7b0257c6b4bd9eee28e099cdc9010c078e8211022eb81adb460c29fbc903bd3ab8addb1ba62eab594267abaf0898817e99271f31d46b3ddee644238900f32.css rel=stylesheet integrity="sha512-yNewJXxrS9nu4o4JnNyQEMB46CEQIuuBrbRgwp+8kDvTq4rdsbpi6rWUJnq68ImIF+mScfMdRrPd7mRCOJAPMg==" crossorigin=anonymous></head><body><header><div class="uk-container uk-container-xsmall uk-padding-small"><a href=https://schrek.fr/><h1 classe=uk-heading-small>Schrek.fr</h1></a><a href=https://schrek.fr/><h2>Mon super blog :)</h2></a></div><nav class="uk-navbar-container uk-navbar-transparent" uk-navbar><div class=uk-navbar-center><ul class=uk-navbar-nav><li class=uk-active><a href=/><span uk-icon="icon:home; ratio: 2"></span></a></li><li class=uk-active><a href=/pages/apropos/><span uk-icon="icon:info; ratio: 2"></span></a></li><li class=uk-active><a href=/wiki/><span uk-icon="icon:database; ratio: 2"></span></a></li><li class=uk-active><a href=/notes/><span uk-icon="icon:pencil; ratio: 2"></span></a></li><li class=uk-active><a href=/pages/tagscloud/><span uk-icon="icon:hashtag; ratio: 2"></span></a></li><li class=uk-active><a href=/pages/search/><span uk-icon="icon:search; ratio: 2"></span></a></li><li class=uk-active><a href=/index.xml><span uk-icon="icon:rss; ratio: 2"></span></a></li></ul></div></nav><hr class=uk-divider-icon></header><main><div class="uk-container uk-background-muted uk-box-shadow-large uk-padding"><ol class=uk-breadcrumb><li><a href=/>home</a></li><li><a href=https://schrek.fr/posts>posts</a></li><li><a href=https://schrek.fr/posts/2023>2023</a></li><li><a href=https://schrek.fr/posts/2023/09>09</a></li><li><a href=https://schrek.fr/posts/2023/09/esp32>esp32</a></li></ol><article class=uk-article><h1 class=uk-article-title>Decouverte de l'Esp32</h1><p class=uk-article-meta>2023-09-05
<span class="labelcat uk-label"><a href=/categories/iot>IoT</a></span><br><i>Temps de lecture: 2 minutes.</i></p><p>Cet article fait partie de la série: <a href=https://schrek.fr//series/esp32>Esp32</a></p><br><p class=uk-text-lead><div class="uk-section uk-align-right"><div class="uk-card-small uk-card-default uk-card-body" uk-scrollspy="cls: uk-animation-slide-right; repeat: false"><h3 class=uk-card-title>Table des matières</h3><p class="toc uk-text-small"><nav id=TableOfContents><ul><li><a href=#installation-esptool>Installation esptool</a></li><li><a href=#installation-micropython>Installation MicroPython</a></li><li><a href=#connection-a-lesp32>Connection a l&rsquo;Esp32</a></li><li><a href=#liens>Liens</a></li></ul></nav></p></div></div><p><a href=https://fr.wikipedia.org/wiki/ESP32>Esp32</a> est un microcontrôleur qui va nous permettre de faire des objets connectés grâce a son module Wifi et Bluetooth intégré.
Il dispose de plusieurs sorties et entrées pour connecter par exemple des capteurs ou des LED.</p><p>On va utiliser <a href=https://fr.wikipedia.org/wiki/MicroPython>Micropython</a> pour assurer la programmation.</p><figure class=imagearticle><img src=/posts/2023/09/esp32/esp321.webp width=400px></figure><figure class=imagearticle><img src=/posts/2023/09/esp32/esp32.webp width=400px></figure><p>Dans un premier temps, il faut changer le logiciel a l’intérieur pour installer MicroPython.</p><h2 id=installation-esptool>Installation esptool</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ apt install esptool</span></span></code></pre></div><p>On branche l&rsquo;esp32 et on lance un dmesg pour savoir ou il se trouve sur les ports.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ dmesg
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cp210x converter now attached to ttyUSB0</span></span></code></pre></div><h2 id=installation-micropython>Installation MicroPython</h2><p>Effacement complet de la carte avec esptool.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ esptool --port /dev/ttyUSB0 erase_flash
</span></span><span style=display:flex><span>esptool.py v2.8
</span></span><span style=display:flex><span>Serial port /dev/ttyUSB0
</span></span><span style=display:flex><span>Connecting........___
</span></span><span style=display:flex><span>Detecting chip type... ESP32
</span></span><span style=display:flex><span>Chip is ESP32D0WDQ6 <span style=color:#f92672>(</span>revision 1<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Features: WiFi, BT, Dual Core, Coding Scheme None
</span></span><span style=display:flex><span>Crystal is 40MHz
</span></span><span style=display:flex><span>MAC: 30:ae:a4:26:d2:00
</span></span><span style=display:flex><span>Enabling default SPI flash mode...
</span></span><span style=display:flex><span>Erasing flash <span style=color:#f92672>(</span>this may take a <span style=color:#66d9ef>while</span><span style=color:#f92672>)</span>...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>A fatal error occurred: ESP32 ROM does not support <span style=color:#66d9ef>function</span> erase_flash.</span></span></code></pre></div><p>ARF ça ne marche pas, faut une version plus récente d&rsquo;esptool.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git clone https://github.com/espressif/esptool.git
</span></span><span style=display:flex><span>$ cd esptool
</span></span><span style=display:flex><span>$ python3 esptool.py --chip esp32 --port /dev/ttyUSB0 erase_flash
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>esptool.py v4.7-dev
</span></span><span style=display:flex><span>Serial port /dev/ttyUSB0
</span></span><span style=display:flex><span>Connecting.....
</span></span><span style=display:flex><span>Chip is ESP32-D0WDQ6 <span style=color:#f92672>(</span>revision v1.0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Features: WiFi, BT, Dual Core, Coding Scheme None
</span></span><span style=display:flex><span>Crystal is 40MHz
</span></span><span style=display:flex><span>MAC: 30:ae:a4:26:d2:00
</span></span><span style=display:flex><span>Uploading stub...
</span></span><span style=display:flex><span>Running stub...
</span></span><span style=display:flex><span>Stub running...
</span></span><span style=display:flex><span>Erasing flash <span style=color:#f92672>(</span>this may take a <span style=color:#66d9ef>while</span><span style=color:#f92672>)</span>...
</span></span><span style=display:flex><span>Chip erase completed successfully in 4.4
</span></span><span style=display:flex><span>Hard resetting via RTS pin...</span></span></code></pre></div><p>Recuperation du microcode sur le site de <a href=https://micropython.org/download/esp32/>MicroPython</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ wget https://micropython.org/resources/firmware/esp32-20230426-v1.20.0.bin</span></span></code></pre></div><p>On injecte le microcode.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ python3 esptool.py --chip esp32 --port /dev/ttyUSB0 --baud <span style=color:#ae81ff>460800</span> write_flash 0x1000 esp32-20230426-v1.20.0.bin 
</span></span><span style=display:flex><span>esptool.py v4.7-dev
</span></span><span style=display:flex><span>Serial port /dev/ttyUSB0
</span></span><span style=display:flex><span>Connecting......
</span></span><span style=display:flex><span>Chip is ESP32-D0WDQ6 <span style=color:#f92672>(</span>revision v1.0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Features: WiFi, BT, Dual Core, Coding Scheme None
</span></span><span style=display:flex><span>Crystal is 40MHz
</span></span><span style=display:flex><span>MAC: 30:ae:a4:26:d2:00
</span></span><span style=display:flex><span>Uploading stub...
</span></span><span style=display:flex><span>Running stub...
</span></span><span style=display:flex><span>Stub running...
</span></span><span style=display:flex><span>Changing baud rate to <span style=color:#ae81ff>460800</span>
</span></span><span style=display:flex><span>Changed.
</span></span><span style=display:flex><span>Configuring flash size...
</span></span><span style=display:flex><span>Flash will be erased from 0x00001000 to 0x0017ffff...
</span></span><span style=display:flex><span>Compressed <span style=color:#ae81ff>1566528</span> bytes to 1034676...
</span></span><span style=display:flex><span>Wrote <span style=color:#ae81ff>1566528</span> bytes <span style=color:#f92672>(</span><span style=color:#ae81ff>1034676</span> compressed<span style=color:#f92672>)</span> at 0x00001000 in 23.5 seconds <span style=color:#f92672>(</span>effective 532.2 kbit/s<span style=color:#f92672>)</span>...
</span></span><span style=display:flex><span>Hash of data verified.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Leaving...
</span></span><span style=display:flex><span>Hard resetting via RTS pin...</span></span></code></pre></div><h2 id=connection-a-lesp32>Connection a l&rsquo;Esp32</h2><p>On va utiliser <a href=https://linux.die.net/man/8/picocom>picocom</a> pour se connecter.<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt install picocom</span></span></code></pre></div></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ picocom /dev/ttyUSB0 -b115200
</span></span><span style=display:flex><span>picocom v3.1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>port is        : /dev/ttyUSB0
</span></span><span style=display:flex><span>flowcontrol    : none
</span></span><span style=display:flex><span>baudrate is    : <span style=color:#ae81ff>115200</span>
</span></span><span style=display:flex><span>parity is      : none
</span></span><span style=display:flex><span>databits are   : <span style=color:#ae81ff>8</span>
</span></span><span style=display:flex><span>stopbits are   : <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>escape is      : C-a
</span></span><span style=display:flex><span>local echo is  : no
</span></span><span style=display:flex><span>noinit is      : no
</span></span><span style=display:flex><span>noreset is     : no
</span></span><span style=display:flex><span>hangup is      : no
</span></span><span style=display:flex><span>nolock is      : no
</span></span><span style=display:flex><span>send_cmd is    : sz -vv
</span></span><span style=display:flex><span>receive_cmd is : rz -vv -E
</span></span><span style=display:flex><span>imap is        : 
</span></span><span style=display:flex><span>omap is        : 
</span></span><span style=display:flex><span>emap is        : crcrlf,delbs,
</span></span><span style=display:flex><span>logfile is     : none
</span></span><span style=display:flex><span>initstring     : none
</span></span><span style=display:flex><span>exit_after is  : not set
</span></span><span style=display:flex><span>exit is        : no
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Type <span style=color:#f92672>[</span>C-a<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>C-h<span style=color:#f92672>]</span> to see available commands
</span></span><span style=display:flex><span>Terminal ready
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&gt;&gt;&gt; print<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;hello esp8266!&#39;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>hello esp8266!
</span></span><span style=display:flex><span>&gt;&gt;&gt; 1+2 
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span></span></span></code></pre></div><h2 id=liens>Liens</h2><p><a href=https://fr.wikipedia.org/wiki/ESP32>https://fr.wikipedia.org/wiki/ESP32</a></p><p><a href=https://fr.wikipedia.org/wiki/MicroPython>https://fr.wikipedia.org/wiki/MicroPython</a></p></p></article><ul class=uk-pagination><li><a class=uk-link-heading href=https://schrek.fr/posts/2023/09/markdown-to-latex/><span class=uk-margin-small-right uk-pagination-previous></span> Convertir de Markdown vers Pdf</a></li><li class=uk-margin-auto-left><a class=uk-link-heading href=https://schrek.fr/posts/2023/09/latex-et-les-codes/>Latex de la couleur dans vos codes<span class=uk-margin-small-left uk-pagination-next></span></a></li></ul><hr class=uk-divider-icon><div class="uk-grid-small uk-child-width-auto" uk-grid><div><p class=uk-text-light><span uk-icon=icon:hashtag></span>TAGS</p><ul class="uk-list uk-display-inline-block"><li><a class="uk-button uk-button-default" href=https://schrek.fr/tags/esp32/>Esp32</a></li><li><a class="uk-button uk-button-default" href=https://schrek.fr/tags/micropython/>MicroPython</a></li><li><a class="uk-button uk-button-default" href=https://schrek.fr/tags/linux/>Linux</a></li></ul><br><a href=https://ko-fi.com/Q5Q7LH0AN target=_blank><img height=36 style=border:0;height:36px src='https://storage.ko-fi.com/cdn/kofi2.png?v=3' border=0 alt='Buy Me a Beer at ko-fi.com'></a></div></div></div></main><footer><div class="uk-container uk-container-small uk-background-muted uk-margin-small-top uk-padding-small">2024 - Construit avec <a class=uk-link-muted href=https://gohugo.io/>Hugo</a> et de <a class=uk-link-muted href=https://getuikit.com/>UiKit</a></div></footer><script src=/js/uikit.min.min.b795e52a95a6766546e08686e5d002243ef20e0fb3c22c860b7bd2adb02129b7.js integrity="sha256-t5XlKpWmdmVG4IaG5dACJD7yDg+zwiyGC3vSrbAhKbc=" crossorigin=anonymous></script><script defer src=/js/uikit-icons.min.min.992015e15d0a403b809bb04d0599e2873818150584953ed5864664037c6b4333.js integrity="sha256-mSAV4V0KQDuAm7BNBZnihzgYFQWElT7VhkZkA3xrQzM=" crossorigin=anonymous></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script><script>MathJax={tex:{displayMath:[["\\[","\\]"],["$$","$$"]],inlineMath:[["\\(","\\)"]]}}</script></body></html>